"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.applyDeviceTokenExists = applyDeviceTokenExists;
exports.bodiesPerLocales = bodiesPerLocales;
exports.getLocalesFromPush = getLocalesFromPush;
exports.groupByLocaleIdentifier = groupByLocaleIdentifier;
exports.isPushIncrementing = isPushIncrementing;
exports.stripLocalesFromBody = stripLocalesFromBody;
exports.transformPushBodyForLocale = transformPushBodyForLocale;
exports.validatePushType = validatePushType;
var _node = _interopRequireDefault(require("parse/node"));
var _deepcopy = _interopRequireDefault(require("deepcopy"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function isPushIncrementing(body) {
  if (!body.data || !body.data.badge) {
    return false;
  }
  const badge = body.data.badge;
  if (typeof badge == 'string' && badge.toLowerCase() == 'increment') {
    return true;
  }
  return typeof badge == 'object' && typeof badge.__op == 'string' && badge.__op.toLowerCase() == 'increment' && Number(badge.amount);
}
const localizableKeys = ['alert', 'title'];
function getLocalesFromPush(body) {
  const data = body.data;
  if (!data) {
    return [];
  }
  return [...new Set(Object.keys(data).reduce((memo, key) => {
    localizableKeys.forEach(localizableKey => {
      if (key.indexOf(`${localizableKey}-`) == 0) {
        memo.push(key.slice(localizableKey.length + 1));
      }
    });
    return memo;
  }, []))];
}
function transformPushBodyForLocale(body, locale) {
  const data = body.data;
  if (!data) {
    return body;
  }
  body = (0, _deepcopy.default)(body);
  localizableKeys.forEach(key => {
    const localeValue = body.data[`${key}-${locale}`];
    if (localeValue) {
      body.data[key] = localeValue;
    }
  });
  return stripLocalesFromBody(body);
}
function stripLocalesFromBody(body) {
  if (!body.data) {
    return body;
  }
  Object.keys(body.data).forEach(key => {
    localizableKeys.forEach(localizableKey => {
      if (key.indexOf(`${localizableKey}-`) == 0) {
        delete body.data[key];
      }
    });
  });
  return body;
}
function bodiesPerLocales(body, locales = []) {
  // Get all tranformed bodies for each locale
  const result = locales.reduce((memo, locale) => {
    memo[locale] = transformPushBodyForLocale(body, locale);
    return memo;
  }, {});
  // Set the default locale, with the stripped body
  result.default = stripLocalesFromBody(body);
  return result;
}
function groupByLocaleIdentifier(installations, locales = []) {
  return installations.reduce((map, installation) => {
    let added = false;
    locales.forEach(locale => {
      if (added) {
        return;
      }
      if (installation.localeIdentifier && installation.localeIdentifier.indexOf(locale) === 0) {
        added = true;
        map[locale] = map[locale] || [];
        map[locale].push(installation);
      }
    });
    if (!added) {
      map.default.push(installation);
    }
    return map;
  }, {
    default: []
  });
}

/**
 * Check whether the deviceType parameter in qury condition is valid or not.
 * @param {Object} where A query condition
 * @param {Array} validPushTypes An array of valid push types(string)
 */
function validatePushType(where = {}, validPushTypes = []) {
  var deviceTypeField = where.deviceType || {};
  var deviceTypes = [];
  if (typeof deviceTypeField === 'string') {
    deviceTypes.push(deviceTypeField);
  } else if (Array.isArray(deviceTypeField['$in'])) {
    deviceTypes.concat(deviceTypeField['$in']);
  }
  for (var i = 0; i < deviceTypes.length; i++) {
    var deviceType = deviceTypes[i];
    if (validPushTypes.indexOf(deviceType) < 0) {
      throw new _node.default.Error(_node.default.Error.PUSH_MISCONFIGURED, deviceType + ' is not supported push type.');
    }
  }
}
function applyDeviceTokenExists(where) {
  where = (0, _deepcopy.default)(where);
  if (!Object.prototype.hasOwnProperty.call(where, 'deviceToken')) {
    where['deviceToken'] = {
      $gt: ''
    }; // change $exists by $gt for better performance
  }

  return where;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbm9kZSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2RlZXBjb3B5Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJpc1B1c2hJbmNyZW1lbnRpbmciLCJib2R5IiwiZGF0YSIsImJhZGdlIiwidG9Mb3dlckNhc2UiLCJfX29wIiwiTnVtYmVyIiwiYW1vdW50IiwibG9jYWxpemFibGVLZXlzIiwiZ2V0TG9jYWxlc0Zyb21QdXNoIiwiU2V0IiwiT2JqZWN0Iiwia2V5cyIsInJlZHVjZSIsIm1lbW8iLCJrZXkiLCJmb3JFYWNoIiwibG9jYWxpemFibGVLZXkiLCJpbmRleE9mIiwicHVzaCIsInNsaWNlIiwibGVuZ3RoIiwidHJhbnNmb3JtUHVzaEJvZHlGb3JMb2NhbGUiLCJsb2NhbGUiLCJkZWVwY29weSIsImxvY2FsZVZhbHVlIiwic3RyaXBMb2NhbGVzRnJvbUJvZHkiLCJib2RpZXNQZXJMb2NhbGVzIiwibG9jYWxlcyIsInJlc3VsdCIsImdyb3VwQnlMb2NhbGVJZGVudGlmaWVyIiwiaW5zdGFsbGF0aW9ucyIsIm1hcCIsImluc3RhbGxhdGlvbiIsImFkZGVkIiwibG9jYWxlSWRlbnRpZmllciIsInZhbGlkYXRlUHVzaFR5cGUiLCJ3aGVyZSIsInZhbGlkUHVzaFR5cGVzIiwiZGV2aWNlVHlwZUZpZWxkIiwiZGV2aWNlVHlwZSIsImRldmljZVR5cGVzIiwiQXJyYXkiLCJpc0FycmF5IiwiY29uY2F0IiwiaSIsIlBhcnNlIiwiRXJyb3IiLCJQVVNIX01JU0NPTkZJR1VSRUQiLCJhcHBseURldmljZVRva2VuRXhpc3RzIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiJGd0Il0sInNvdXJjZXMiOlsiLi4vLi4vc3JjL1B1c2gvdXRpbHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFBhcnNlIGZyb20gJ3BhcnNlL25vZGUnO1xuaW1wb3J0IGRlZXBjb3B5IGZyb20gJ2RlZXBjb3B5JztcblxuZXhwb3J0IGZ1bmN0aW9uIGlzUHVzaEluY3JlbWVudGluZyhib2R5KSB7XG4gIGlmICghYm9keS5kYXRhIHx8ICFib2R5LmRhdGEuYmFkZ2UpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBjb25zdCBiYWRnZSA9IGJvZHkuZGF0YS5iYWRnZTtcbiAgaWYgKHR5cGVvZiBiYWRnZSA9PSAnc3RyaW5nJyAmJiBiYWRnZS50b0xvd2VyQ2FzZSgpID09ICdpbmNyZW1lbnQnKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICByZXR1cm4gKFxuICAgIHR5cGVvZiBiYWRnZSA9PSAnb2JqZWN0JyAmJlxuICAgIHR5cGVvZiBiYWRnZS5fX29wID09ICdzdHJpbmcnICYmXG4gICAgYmFkZ2UuX19vcC50b0xvd2VyQ2FzZSgpID09ICdpbmNyZW1lbnQnICYmXG4gICAgTnVtYmVyKGJhZGdlLmFtb3VudClcbiAgKTtcbn1cblxuY29uc3QgbG9jYWxpemFibGVLZXlzID0gWydhbGVydCcsICd0aXRsZSddO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TG9jYWxlc0Zyb21QdXNoKGJvZHkpIHtcbiAgY29uc3QgZGF0YSA9IGJvZHkuZGF0YTtcbiAgaWYgKCFkYXRhKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHJldHVybiBbXG4gICAgLi4ubmV3IFNldChcbiAgICAgIE9iamVjdC5rZXlzKGRhdGEpLnJlZHVjZSgobWVtbywga2V5KSA9PiB7XG4gICAgICAgIGxvY2FsaXphYmxlS2V5cy5mb3JFYWNoKGxvY2FsaXphYmxlS2V5ID0+IHtcbiAgICAgICAgICBpZiAoa2V5LmluZGV4T2YoYCR7bG9jYWxpemFibGVLZXl9LWApID09IDApIHtcbiAgICAgICAgICAgIG1lbW8ucHVzaChrZXkuc2xpY2UobG9jYWxpemFibGVLZXkubGVuZ3RoICsgMSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBtZW1vO1xuICAgICAgfSwgW10pXG4gICAgKSxcbiAgXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRyYW5zZm9ybVB1c2hCb2R5Rm9yTG9jYWxlKGJvZHksIGxvY2FsZSkge1xuICBjb25zdCBkYXRhID0gYm9keS5kYXRhO1xuICBpZiAoIWRhdGEpIHtcbiAgICByZXR1cm4gYm9keTtcbiAgfVxuICBib2R5ID0gZGVlcGNvcHkoYm9keSk7XG4gIGxvY2FsaXphYmxlS2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgY29uc3QgbG9jYWxlVmFsdWUgPSBib2R5LmRhdGFbYCR7a2V5fS0ke2xvY2FsZX1gXTtcbiAgICBpZiAobG9jYWxlVmFsdWUpIHtcbiAgICAgIGJvZHkuZGF0YVtrZXldID0gbG9jYWxlVmFsdWU7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHN0cmlwTG9jYWxlc0Zyb21Cb2R5KGJvZHkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc3RyaXBMb2NhbGVzRnJvbUJvZHkoYm9keSkge1xuICBpZiAoIWJvZHkuZGF0YSkge1xuICAgIHJldHVybiBib2R5O1xuICB9XG4gIE9iamVjdC5rZXlzKGJvZHkuZGF0YSkuZm9yRWFjaChrZXkgPT4ge1xuICAgIGxvY2FsaXphYmxlS2V5cy5mb3JFYWNoKGxvY2FsaXphYmxlS2V5ID0+IHtcbiAgICAgIGlmIChrZXkuaW5kZXhPZihgJHtsb2NhbGl6YWJsZUtleX0tYCkgPT0gMCkge1xuICAgICAgICBkZWxldGUgYm9keS5kYXRhW2tleV07XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuICByZXR1cm4gYm9keTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJvZGllc1BlckxvY2FsZXMoYm9keSwgbG9jYWxlcyA9IFtdKSB7XG4gIC8vIEdldCBhbGwgdHJhbmZvcm1lZCBib2RpZXMgZm9yIGVhY2ggbG9jYWxlXG4gIGNvbnN0IHJlc3VsdCA9IGxvY2FsZXMucmVkdWNlKChtZW1vLCBsb2NhbGUpID0+IHtcbiAgICBtZW1vW2xvY2FsZV0gPSB0cmFuc2Zvcm1QdXNoQm9keUZvckxvY2FsZShib2R5LCBsb2NhbGUpO1xuICAgIHJldHVybiBtZW1vO1xuICB9LCB7fSk7XG4gIC8vIFNldCB0aGUgZGVmYXVsdCBsb2NhbGUsIHdpdGggdGhlIHN0cmlwcGVkIGJvZHlcbiAgcmVzdWx0LmRlZmF1bHQgPSBzdHJpcExvY2FsZXNGcm9tQm9keShib2R5KTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwQnlMb2NhbGVJZGVudGlmaWVyKGluc3RhbGxhdGlvbnMsIGxvY2FsZXMgPSBbXSkge1xuICByZXR1cm4gaW5zdGFsbGF0aW9ucy5yZWR1Y2UoXG4gICAgKG1hcCwgaW5zdGFsbGF0aW9uKSA9PiB7XG4gICAgICBsZXQgYWRkZWQgPSBmYWxzZTtcbiAgICAgIGxvY2FsZXMuZm9yRWFjaChsb2NhbGUgPT4ge1xuICAgICAgICBpZiAoYWRkZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGluc3RhbGxhdGlvbi5sb2NhbGVJZGVudGlmaWVyICYmIGluc3RhbGxhdGlvbi5sb2NhbGVJZGVudGlmaWVyLmluZGV4T2YobG9jYWxlKSA9PT0gMCkge1xuICAgICAgICAgIGFkZGVkID0gdHJ1ZTtcbiAgICAgICAgICBtYXBbbG9jYWxlXSA9IG1hcFtsb2NhbGVdIHx8IFtdO1xuICAgICAgICAgIG1hcFtsb2NhbGVdLnB1c2goaW5zdGFsbGF0aW9uKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAoIWFkZGVkKSB7XG4gICAgICAgIG1hcC5kZWZhdWx0LnB1c2goaW5zdGFsbGF0aW9uKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBtYXA7XG4gICAgfSxcbiAgICB7IGRlZmF1bHQ6IFtdIH1cbiAgKTtcbn1cblxuLyoqXG4gKiBDaGVjayB3aGV0aGVyIHRoZSBkZXZpY2VUeXBlIHBhcmFtZXRlciBpbiBxdXJ5IGNvbmRpdGlvbiBpcyB2YWxpZCBvciBub3QuXG4gKiBAcGFyYW0ge09iamVjdH0gd2hlcmUgQSBxdWVyeSBjb25kaXRpb25cbiAqIEBwYXJhbSB7QXJyYXl9IHZhbGlkUHVzaFR5cGVzIEFuIGFycmF5IG9mIHZhbGlkIHB1c2ggdHlwZXMoc3RyaW5nKVxuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVQdXNoVHlwZSh3aGVyZSA9IHt9LCB2YWxpZFB1c2hUeXBlcyA9IFtdKSB7XG4gIHZhciBkZXZpY2VUeXBlRmllbGQgPSB3aGVyZS5kZXZpY2VUeXBlIHx8IHt9O1xuICB2YXIgZGV2aWNlVHlwZXMgPSBbXTtcbiAgaWYgKHR5cGVvZiBkZXZpY2VUeXBlRmllbGQgPT09ICdzdHJpbmcnKSB7XG4gICAgZGV2aWNlVHlwZXMucHVzaChkZXZpY2VUeXBlRmllbGQpO1xuICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoZGV2aWNlVHlwZUZpZWxkWyckaW4nXSkpIHtcbiAgICBkZXZpY2VUeXBlcy5jb25jYXQoZGV2aWNlVHlwZUZpZWxkWyckaW4nXSk7XG4gIH1cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBkZXZpY2VUeXBlcy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBkZXZpY2VUeXBlID0gZGV2aWNlVHlwZXNbaV07XG4gICAgaWYgKHZhbGlkUHVzaFR5cGVzLmluZGV4T2YoZGV2aWNlVHlwZSkgPCAwKSB7XG4gICAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoXG4gICAgICAgIFBhcnNlLkVycm9yLlBVU0hfTUlTQ09ORklHVVJFRCxcbiAgICAgICAgZGV2aWNlVHlwZSArICcgaXMgbm90IHN1cHBvcnRlZCBwdXNoIHR5cGUuJ1xuICAgICAgKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5RGV2aWNlVG9rZW5FeGlzdHMod2hlcmUpIHtcbiAgd2hlcmUgPSBkZWVwY29weSh3aGVyZSk7XG4gIGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHdoZXJlLCAnZGV2aWNlVG9rZW4nKSkge1xuICAgIHdoZXJlWydkZXZpY2VUb2tlbiddID0geyAkZ3Q6ICcnIH07IC8vIGNoYW5nZSAkZXhpc3RzIGJ5ICRndCBmb3Ig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